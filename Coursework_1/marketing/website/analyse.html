<head>
  <!-- Plotly.js -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="js/jquery.csv.min.js"></script> 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> 
  <script>
  $(document).ready(function(){
          $("#div1").load("sleeprating.txt");
  });
  </script>
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="vendor/simple-line-icons/css/simple-line-icons.css">
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">
  <link rel="icon" href="img/logo.png">
  <!-- Plugin CSS -->
  <link rel="stylesheet" href="device-mockups/device-mockups.min.css">

  <!-- Custom styles for this template -->
	<link href="css/new-age.min.css" rel="stylesheet">
	
	<title>SmartPillow - Sleep Analysis</title>
</head>

<body>
	<section class="bg-dark">
		<div class="bg-dark text-white">
	<!-- Navigation -->
			<center><h1>How was your sleep? </h1> </center>
		</div>
		<div class="bg-dark text-info">
			<center>Sleep phases are represented from 0 (Awake) to 5 (Deepest) </center>
			<a href="index.html"> <i class="fa fa-3x fa-arrow-circle-left"></i> </a>
		</div>
	</section>
  
	<section class="download text-center" id="download">
		<h1> Your sleep: </h1>
		<div class="bg-info" id="myDiv"><!-- Plotly chart will be drawn inside this DIV --></div>
		<h1> An ideal sleep: </h1>
    <div> <img src="img/ideal_sleep.jpeg"> </div>
	</section>
	
  	<section class="download bg-info text-light text-center" id="download">
  		<p>
  		Your sleep rating was:
  		</p>
  		<div id="div1"><h2>Reading in your rating...</h2></div>
  		<div>/10</div>
  	</section>


  <script>
  	function makeplot() {
  	    Plotly.d3.csv("http://46.101.14.145/aufars_sleep.csv", function(data){ processData(data) } );
  	};
  	    
  	function processData(allRows) {

  	    console.log(allRows);
  	    var x = [], y = [], standard_deviation = [];

  	    for (var i=0; i<allRows.length; i++) {
  	        row = allRows[i];
  	        x.push( row['Time'] );
  	        y.push( row['Phase'] );
  	    }
  	    console.log( 'X',x, 'Y',y, 'SD',standard_deviation );
  	    makePlotly( x, y, standard_deviation );
  	}

  	function makePlotly( x, y, standard_deviation ){
  	    var plotDiv = document.getElementById("plot");
  	    var traces1 = [{
  	        x: x, 
  	        y: y,
  	        marker: {
  	          color: '#23b7e5'
  	        }
  	    }];

  	    var layout = {
  			title:'Look at how you slept last night',
  			plot_bgcolor: 'rgba(255, 255, 255, 0.5);',
 			xaxis: {
 			  title: 'Time',
 			  titlefont: {
 			    color: 'black',
 			    size: 12
 			  },
 			  rangemode: 'tozero'
 			},
 			yaxis: {
 			  title: 'Phase',
 			  titlefont: {
 			    color: 'black',
 			    size: 12
 			  },
 			  rangemode: 'tozero',
 			  autorange: "reversed"
 			}
		};

  	    Plotly.newPlot('myDiv', traces1, 
  	        layout);
  	};
  	  makeplot();
  </script>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Plugin JavaScript -->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Custom scripts for this template -->
  <script src="js/new-age.js"></script>
</body>
